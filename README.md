# TEMT6000-ESP32-Driver

## Introduction

Project includes component for controlling [TEMT6000](https://www.vishay.com/product/81579/) device. It is compatible with ESP32 microcontrollers. Source code of the driver has been written in C. 

It is written and tested for v4.4.2 of the [ESP-IDF](https://github.com/espressif/esp-idf) environment using the xtensa-esp32-elf toolchain (gcc version 8.4.0).

## Build

To include the component into your ESP-IDF project, you need to create `CMakeLists.txt` file containing:
```cmake
idf_component_register(
    SRC_DIRS "." 
    INCLUDE_DIRS "/include"
    REQUIRES "esp_adc_cal"
)
```

Consult [ESP-IDF documentation](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-guides/build-system.html) for more details about build system.

## Features

✔️ Static memory allocation <br />

✔️ Instantiation - using many driver instances simultaneously is possible <br />

✔️ Supports measurement of light intensity (in %) and illuminance (in lux) based on voltage generated by the device (using ADC) <br />

## Example

Below is the example of using the driver.

```c
// Selected GPIO is 36 based on chosen ADC unit and ADC channel
#define TEMT6000_ADC_UNIT       ADC_UNIT_1      // Chosen ADC unit
#define TEMT6000_ADC_CHANNEL    ADC_CHANNEL_0   // Chosen ADC channel
#define TEMT6000_SAMPLES_NUM    10              // Number of measurement samples

TEMT6000_t device;
if (TEMT6000_OK != temt6000__Init(&device, TEMT6000_ADC_UNIT, TEMT6000_ADC_CHANNEL))
{
    // Error handling
}

while (1)
{
    TEMT6000_measurement_data_t measurement;
    if (TEMT6000_OK != temt6000__ReadLightIntensity(&device, TEMT6000_SAMPLES_NO, &measurement.lightIntensity))
    {
        // Error handling
    }
    printf("Light intensity: %.2f%%", measurement.lightIntensity);
    
    TEMT6000_illuminance_t illuminance;
    if (TEMT6000_OK != temt6000__ReadIlluminance(&device, TEMT6000_SAMPLES_NO, &measurement.illuminance))
    {
        // Error handling
    }
    printf("Illuminance: %.2f lux", measurement.illuminance);

    // Delay infinite loop for some time
}
```

## Documentation

Generated API documentation is available [here](http://dziamian.github.io/TEMT6000-ESP32-Driver).

## Source Code

The source code is available on [GitHub](https://github.com/dziamian/TEMT6000-ESP32-Driver).

## License

The code in this project is licensed under the MIT license - see [LICENSE.md](https://github.com/dziamian/TEMT6000-ESP32-Driver/blob/main/LICENSE.md) for details.

## Links
 
 * [ESP-IDF](https://github.com/espressif/esp-idf)
 * [TEMT6000](https://www.vishay.com/product/81579/)
 * [TEMT6000 Datasheet](https://www.vishay.com/docs/81579/temt6000.pdf)